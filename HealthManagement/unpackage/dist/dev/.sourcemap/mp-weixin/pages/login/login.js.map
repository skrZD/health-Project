{"version":3,"file":"login.js","sources":["pages/login/login.vue","S:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbG9naW4vbG9naW4udnVl"],"sourcesContent":["<template>\r\n\t<view class=\"login-container\">\r\n\t\t<view class=\"login-header\">\r\n\t\t\t<image class=\"logo\" src=\"/static/logo.png\" mode=\"aspectFit\"></image>\r\n\t\t\t<text class=\"app-name\">ÂÅ•Â∫∑ÁÆ°ÁêÜ</text>\r\n\t\t\t<text class=\"app-desc\">ËÆ∞ÂΩïÂÅ•Â∫∑ÔºåÁÆ°ÁêÜÁîüÊ¥ª</text>\r\n\t\t</view>\r\n\t\t\r\n\t\t<view class=\"login-content\">\r\n\t\t\t<button \r\n\t\t\t\tclass=\"login-btn\" \r\n\t\t\t\t@click=\"handleWechatLogin\"\r\n\t\t\t\t:loading=\"isLoading\"\r\n\t\t\t\t:disabled=\"isLoading\"\r\n\t\t\t>\r\n\t\t\t\t<text class=\"btn-icon\">üîê</text>\r\n\t\t\t\t<text class=\"btn-text\">{{ isLoading ? 'ÁôªÂΩï‰∏≠...' : 'ÂæÆ‰ø°ÊéàÊùÉÁôªÂΩï' }}</text>\r\n\t\t\t</button>\r\n\t\t\t\r\n\t\t\t<view class=\"login-tips\">\r\n\t\t\t\t<text class=\"tips-text\">ÁôªÂΩïÂç≥Ë°®Á§∫ÂêåÊÑè</text>\r\n\t\t\t\t<text class=\"link-text\" @click=\"showPrivacy\">„ÄäÈöêÁßÅÊîøÁ≠ñ„Äã</text>\r\n\t\t\t\t<text class=\"tips-text\">Âíå</text>\r\n\t\t\t\t<text class=\"link-text\" @click=\"showTerms\">„ÄäÁî®Êà∑ÂçèËÆÆ„Äã</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<view class=\"login-footer\">\r\n\t\t\t<text class=\"version\">v1.0.0</text>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nimport apiConfig from '@/api/config.js'\r\n\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tisLoading: false\r\n\t\t}\r\n\t},\r\n\tonLoad() {\r\n\t\t// Ê£ÄÊü•ÊòØÂê¶Â∑≤ÁôªÂΩï\r\n\t\tthis.checkLoginStatus()\r\n\t},\r\n\tmethods: {\r\n\t\t// Ê£ÄÊü•ÁôªÂΩïÁä∂ÊÄÅ\r\n\t\tcheckLoginStatus() {\r\n\t\t\tconst token = uni.getStorageSync('token')\r\n\t\t\tconst userInfo = uni.getStorageSync('userInfo')\r\n\t\t\t\r\n\t\t\tif (token && userInfo) {\r\n\t\t\t\t// È™åËØÅtokenÊúâÊïàÊÄß\r\n\t\t\t\tthis.validateToken(token)\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// È™åËØÅtokenÊúâÊïàÊÄß\r\n\t\tvalidateToken(token) {\r\n\t\t\tuni.request({\r\n\t\t\t\turl: apiConfig.API_CONFIG.BASE_URL + apiConfig.API_CONFIG.AUTH.ME,\r\n\t\t\t\tmethod: 'GET',\r\n\t\t\t\theader: {\r\n\t\t\t\t\t'Authorization': 'Bearer ' + token\r\n\t\t\t\t},\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tif (res.data.code === 0) {\r\n\t\t\t\t\t\t// tokenÊúâÊïàÔºåÁõ¥Êé•Ë∑≥ËΩ¨Âà∞È¶ñÈ°µ\r\n\t\t\t\t\t\tuni.switchTab({\r\n\t\t\t\t\t\t\turl: '/pages/index/index'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// tokenÊó†ÊïàÔºåÊ∏ÖÈô§Êú¨Âú∞Â≠òÂÇ®\r\n\t\t\t\t\t\tthis.clearLoginData()\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfail: () => {\r\n\t\t\t\t\t// ÁΩëÁªúÈîôËØØÔºåÊ∏ÖÈô§Êú¨Âú∞Â≠òÂÇ®\r\n\t\t\t\t\tthis.clearLoginData()\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\t\r\n\t\t// ÂæÆ‰ø°ÁôªÂΩï\r\n\t\thandleWechatLogin() {\r\n\t\t\tif (this.isLoading) return\r\n\t\t\t\r\n\t\t\tthis.isLoading = true\r\n\t\t\t\r\n\t\t\t// Ëé∑ÂèñÂæÆ‰ø°ÁôªÂΩïcode\r\n\t\t\tuni.login({\r\n\t\t\t\tprovider: 'weixin',\r\n\t\t\t\tsuccess: (loginRes) => {\r\n\t\t\t\t\tif (loginRes.code) {\r\n\t\t\t\t\t\t// Ë∞ÉÁî®ÂêéÁ´ØÁôªÂΩïÊé•Âè£\r\n\t\t\t\t\t\tthis.loginWithCode(loginRes.code)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.isLoading = false\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: 'Ëé∑ÂèñÁôªÂΩïÂá≠ËØÅÂ§±Ë¥•',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\tthis.isLoading = false\r\n\t\t\t\t\tconsole.error('ÂæÆ‰ø°ÁôªÂΩïÂ§±Ë¥•:', err)\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: 'ÂæÆ‰ø°ÁôªÂΩïÂ§±Ë¥•',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\t\r\n\t\t// ‰ΩøÁî®codeÁôªÂΩï\r\n\t\tloginWithCode(code) {\r\n\t\t\tuni.request({\r\n\t\t\t\turl: apiConfig.API_CONFIG.BASE_URL + apiConfig.API_CONFIG.AUTH.LOGIN,\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tcode: code\r\n\t\t\t\t},\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tthis.isLoading = false\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (res.data.code === 0) {\r\n\t\t\t\t\t\tconst { token, user } = res.data.data\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// ‰øùÂ≠òÁôªÂΩï‰ø°ÊÅØ\r\n\t\t\t\t\t\tuni.setStorageSync('token', token)\r\n\t\t\t\t\t\tuni.setStorageSync('userInfo', user)\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: 'ÁôªÂΩïÊàêÂäü',\r\n\t\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// Ë∑≥ËΩ¨Âà∞È¶ñÈ°µ\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tuni.switchTab({\r\n\t\t\t\t\t\t\t\turl: '/pages/index/index'\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}, 1500)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: res.data.message || 'ÁôªÂΩïÂ§±Ë¥•',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\tthis.isLoading = false\r\n\t\t\t\t\tconsole.error('ÁôªÂΩïËØ∑Ê±ÇÂ§±Ë¥•:', err)\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: 'ÁΩëÁªúÈîôËØØÔºåËØ∑ÈáçËØï',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\t\r\n\t\t// Ê∏ÖÈô§ÁôªÂΩïÊï∞ÊçÆ\r\n\t\tclearLoginData() {\r\n\t\t\tuni.removeStorageSync('token')\r\n\t\t\tuni.removeStorageSync('userInfo')\r\n\t\t},\r\n\t\t\r\n\t\t// ÊòæÁ§∫ÈöêÁßÅÊîøÁ≠ñ\r\n\t\tshowPrivacy() {\r\n\t\t\tuni.showModal({\r\n\t\t\t\ttitle: 'ÈöêÁßÅÊîøÁ≠ñ',\r\n\t\t\t\tcontent: 'Êàë‰ª¨ÈáçËßÜÊÇ®ÁöÑÈöêÁßÅ‰øùÊä§...',\r\n\t\t\t\tshowCancel: false\r\n\t\t\t})\r\n\t\t},\r\n\t\t\r\n\t\t// ÊòæÁ§∫Áî®Êà∑ÂçèËÆÆ\r\n\t\tshowTerms() {\r\n\t\t\tuni.showModal({\r\n\t\t\t\ttitle: 'Áî®Êà∑ÂçèËÆÆ',\r\n\t\t\t\tcontent: 'Ê¨¢Ëøé‰ΩøÁî®ÂÅ•Â∫∑ÁÆ°ÁêÜÂ∫îÁî®...',\r\n\t\t\t\tshowCancel: false\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.login-container {\r\n\twidth: 100%;\r\n\theight: 100vh;\r\n\tbackground: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tpadding: 40rpx;\r\n\tbox-sizing: border-box;\r\n}\r\n\r\n.login-header {\r\n\ttext-align: center;\r\n\tmargin-bottom: 120rpx;\r\n}\r\n\r\n.logo {\r\n\twidth: 120rpx;\r\n\theight: 120rpx;\r\n\tmargin-bottom: 30rpx;\r\n}\r\n\r\n.app-name {\r\n\tdisplay: block;\r\n\tfont-size: 48rpx;\r\n\tfont-weight: bold;\r\n\tcolor: #ffffff;\r\n\tmargin-bottom: 20rpx;\r\n}\r\n\r\n.app-desc {\r\n\tdisplay: block;\r\n\tfont-size: 28rpx;\r\n\tcolor: rgba(255, 255, 255, 0.8);\r\n}\r\n\r\n.login-content {\r\n\twidth: 100%;\r\n\tmax-width: 600rpx;\r\n}\r\n\r\n.login-btn {\r\n\twidth: 100%;\r\n\theight: 88rpx;\r\n\tbackground: #ffffff;\r\n\tborder-radius: 44rpx;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tmargin-bottom: 40rpx;\r\n\tbox-shadow: 0 8rpx 24rpx rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.btn-icon {\r\n\tfont-size: 32rpx;\r\n\tmargin-right: 16rpx;\r\n}\r\n\r\n.btn-text {\r\n\tfont-size: 32rpx;\r\n\tfont-weight: 500;\r\n\tcolor: #333333;\r\n}\r\n\r\n.login-tips {\r\n\ttext-align: center;\r\n\tfont-size: 24rpx;\r\n\tcolor: rgba(255, 255, 255, 0.7);\r\n\tline-height: 1.5;\r\n}\r\n\r\n.link-text {\r\n\tcolor: #ffffff;\r\n\ttext-decoration: underline;\r\n}\r\n\r\n.login-footer {\r\n\tposition: absolute;\r\n\tbottom: 60rpx;\r\n\ttext-align: center;\r\n}\r\n\r\n.version {\r\n\tfont-size: 24rpx;\r\n\tcolor: rgba(255, 255, 255, 0.5);\r\n}\r\n</style>\r\n\r\n","import MiniProgramPage from 'D:/HBuilder/HealthManagement/pages/login/login.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","apiConfig"],"mappings":"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"}