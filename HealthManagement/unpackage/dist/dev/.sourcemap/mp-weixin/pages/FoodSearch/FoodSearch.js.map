{"version":3,"file":"FoodSearch.js","sources":["pages/FoodSearch/FoodSearch.vue","S:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvRm9vZFNlYXJjaC9Gb29kU2VhcmNoLnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"foodSearch\">\n\t\t<view class=\"search_bar\">\n\t\t\t<input class=\"search_input\" v-model=\"keyword\" placeholder=\"搜索食物名称\" confirm-type=\"search\" @confirm=\"search\"/>\n\t\t\t<button class=\"search_btn\" @click=\"search\">搜索</button>\n\t\t</view>\n\t\t<view class=\"category_bar\">\n\t\t\t<scroll-view scroll-x class=\"cat_scroll\">\n\t\t\t\t<view class=\"cat_item\" :class=\"{active: activeCat === c.id}\" v-for=\"c in categories\" :key=\"c.id\" @click=\"selectCat(c.id)\">{{c.name}}</view>\n\t\t\t</scroll-view>\n\t\t</view>\n\t\t<view class=\"list_box\">\n\t\t\t<view class=\"food_item\" v-for=\"f in foods\" :key=\"f.id\" @click=\"chooseFood(f)\">\n\t\t\t\t<view class=\"food_name\">{{f.name}}</view>\n\t\t\t\t<view class=\"food_kcal\">{{f.caloriesPer100}} kcal/100g</view>\n\t\t\t</view>\n\t\t\t<view v-if=\"foods.length===0\" class=\"empty\">暂无数据</view>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\nexport default {\n\tdata(){\n\t\treturn {\n\t\t\tkeyword: '',\n\t\t\tactiveCat: null,\n\t\t\tcategories: [\n\t\t\t\t{ id: 0, name: '全部' },\n\t\t\t\t{ id: 1, name: '主食' },\n\t\t\t\t{ id: 2, name: '肉蛋奶' },\n\t\t\t\t{ id: 3, name: '蔬果' }\n\t\t\t],\n\t\t\tfoods: []\n\t\t};\n\t},\n\tonLoad(){\n\t\tthis.search();\n\t},\n\tmethods:{\n\t\tselectCat(id){\n\t\t\tthis.activeCat = id;\n\t\t\tthis.search();\n\t\t},\n\t\tsearch(){\n\t\t\t// 调用后端API搜索食物\n\t\t\tconst params = {\n\t\t\t\tq: this.keyword,\n\t\t\t\tpage: 1,\n\t\t\t\tsize: 50\n\t\t\t};\n\t\t\t\n\t\t\t// 只有当activeCat不为0时才添加categoryId参数\n\t\t\tif (this.activeCat !== 0) {\n\t\t\t\tparams.categoryId = this.activeCat;\n\t\t\t}\n\t\t\t\n\t\t\tuni.request({\n\t\t\t\turl: 'http://localhost:8088/api/foods/search',\n\t\t\t\tmethod: 'GET',\n\t\t\t\tdata: params,\n\t\t\t\tsuccess: (res) => {\n\t\t\t\t\tif (res.data.code === 0) {\n\t\t\t\t\t\tthis.foods = res.data.data.records || [];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tuni.showToast({ title: '搜索失败', icon: 'none' });\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfail: () => {\n\t\t\t\t\t// 如果API调用失败，使用mock数据\n\t\t\t\t\tconst all = [\n\t\t\t\t\t\t{ id: 101, name: '鸡胸肉', caloriesPer100: 165 },\n\t\t\t\t\t\t{ id: 102, name: '米饭', caloriesPer100: 116 },\n\t\t\t\t\t\t{ id: 103, name: '西兰花', caloriesPer100: 33 }\n\t\t\t\t\t];\n\t\t\t\t\tthis.foods = all.filter(x => !this.keyword || x.name.includes(this.keyword));\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tchooseFood(food){\n\t\t\t// 选择后返回上一页并带参数\n\t\t\tconst eventChannel = this.getOpenerEventChannel();\n\t\t\t// 统一字段名，将caloriesPer100转换为calories_per_100\n\t\t\tconst selectedFood = {\n\t\t\t\t...food,\n\t\t\t\tcalories_per_100: food.caloriesPer100\n\t\t\t};\n\t\t\teventChannel.emit('foodSelected', selectedFood);\n\t\t\tuni.navigateBack();\n\t\t}\n\t}\n}\n</script>\n\n<style scoped>\n.foodSearch{ padding: 10px; }\n.search_bar{ display:flex; gap:8px; }\n.search_input{ flex:1; height:36px; border:1px solid #eee; border-radius:8px; padding:0 10px; }\n.search_btn{ background:#4A89FF; color:#fff; border:none; border-radius:8px; padding:0 14px; }\n.cat_scroll{ white-space:nowrap; padding:10px 0; }\n.cat_item{ display:inline-block; padding:6px 12px; margin-right:8px; background:#f5f5f5; border-radius:14px; }\n.cat_item.active{ background:#4A89FF; color:#fff; }\n.list_box{ background:#fff; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,.06); }\n.food_item{ display:flex; justify-content:space-between; padding:12px 14px; border-bottom:1px solid #f0f0f0; }\n.food_item:last-child{ border-bottom:none; }\n.food_name{ font-weight:bold; }\n.food_kcal{ color:#666; }\n.empty{ text-align:center; color:#999; padding:20px; }\n</style>\n\n\n","import MiniProgramPage from 'D:/HBuilder/HealthManagement/pages/FoodSearch/FoodSearch.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":";;AAsBA,MAAK,YAAU;AAAA,EACd,OAAM;AACL,WAAO;AAAA,MACN,SAAS;AAAA,MACT,WAAW;AAAA,MACX,YAAY;AAAA,QACX,EAAE,IAAI,GAAG,MAAM,KAAM;AAAA,QACrB,EAAE,IAAI,GAAG,MAAM,KAAM;AAAA,QACrB,EAAE,IAAI,GAAG,MAAM,MAAO;AAAA,QACtB,EAAE,IAAI,GAAG,MAAM,KAAK;AAAA,MACpB;AAAA,MACD,OAAO,CAAC;AAAA;EAET;AAAA,EACD,SAAQ;AACP,SAAK,OAAM;AAAA,EACX;AAAA,EACD,SAAQ;AAAA,IACP,UAAU,IAAG;AACZ,WAAK,YAAY;AACjB,WAAK,OAAM;AAAA,IACX;AAAA,IACD,SAAQ;AAEP,YAAM,SAAS;AAAA,QACd,GAAG,KAAK;AAAA,QACR,MAAM;AAAA,QACN,MAAM;AAAA;AAIP,UAAI,KAAK,cAAc,GAAG;AACzB,eAAO,aAAa,KAAK;AAAA,MAC1B;AAEAA,oBAAAA,MAAI,QAAQ;AAAA,QACX,KAAK;AAAA,QACL,QAAQ;AAAA,QACR,MAAM;AAAA,QACN,SAAS,CAAC,QAAQ;AACjB,cAAI,IAAI,KAAK,SAAS,GAAG;AACxB,iBAAK,QAAQ,IAAI,KAAK,KAAK,WAAW;iBAChC;AACNA,0BAAG,MAAC,UAAU,EAAE,OAAO,QAAQ,MAAM,OAAK,CAAG;AAAA,UAC9C;AAAA,QACA;AAAA,QACD,MAAM,MAAM;AAEX,gBAAM,MAAM;AAAA,YACX,EAAE,IAAI,KAAK,MAAM,OAAO,gBAAgB,IAAK;AAAA,YAC7C,EAAE,IAAI,KAAK,MAAM,MAAM,gBAAgB,IAAK;AAAA,YAC5C,EAAE,IAAI,KAAK,MAAM,OAAO,gBAAgB,GAAG;AAAA;AAE5C,eAAK,QAAQ,IAAI,OAAO,OAAK,CAAC,KAAK,WAAW,EAAE,KAAK,SAAS,KAAK,OAAO,CAAC;AAAA,QAC5E;AAAA,MACD,CAAC;AAAA,IACD;AAAA,IACD,WAAW,MAAK;AAEf,YAAM,eAAe,KAAK;AAE1B,YAAM,eAAe;AAAA,QACpB,GAAG;AAAA,QACH,kBAAkB,KAAK;AAAA;AAExB,mBAAa,KAAK,gBAAgB,YAAY;AAC9CA,oBAAG,MAAC,aAAY;AAAA,IACjB;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1FA,GAAG,WAAW,eAAe;"}